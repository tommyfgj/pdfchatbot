# 📘 使用指南

## 🎯 核心功能：在 PDF 文本选择菜单中添加"发送到 AI"按钮

### 工作流程

```
┌─────────────────────────────────────────────────────────────┐
│  1. 用户在 PDF 中选择文本                                      │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│  2. pdfjs-annotation-extension 显示批注菜单                   │
│     ┌──────────────────────────────────┐                    │
│     │  📝 高亮                          │                    │
│     │  📝 下划线                        │                    │
│     │  📝 删除线                        │                    │
│     │  💬 发送到 AI  ← 新增按钮         │                    │
│     └──────────────────────────────────┘                    │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│  3. 用户点击"💬 发送到 AI"按钮                                │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│  4. 选中的文本自动填充到右侧聊天框                             │
│     格式：请解释以下内容：                                     │
│           "[选中的文本]"                                      │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│  5. 用户点击发送，AI 开始回答                                  │
└─────────────────────────────────────────────────────────────┘
```

## 📝 详细步骤

### 步骤 1：上传 PDF

1. 打开应用：http://localhost:3000
2. 点击左上角"上传 PDF"按钮
3. 选择你的 PDF 文件

### 步骤 2：阅读和批注

**使用 PDF Viewer 功能：**
- 🔍 缩放：使用工具栏的缩放按钮
- 📄 翻页：点击上一页/下一页
- 🔎 搜索：使用搜索功能查找文本
- 📑 侧边栏：查看缩略图、大纲

**添加批注：**
- 使用批注工具栏的各种工具
- 矩形、圆形、箭头等
- 自由绘制、签名、印章

### 步骤 3：选择文本并发送到 AI

1. **选择文本**
   - 用鼠标拖动选择 PDF 中的任意文本
   - 可以是一个词、一句话或一段话

2. **查看菜单**
   - 选择文本后会弹出菜单
   - 菜单包含：
     - 📝 高亮（黄色、绿色等）
     - 📝 下划线
     - 📝 删除线
     - 💬 **发送到 AI** ← 这是新增的按钮

3. **点击"发送到 AI"**
   - 点击蓝色的"💬 发送到 AI"按钮
   - 菜单会自动关闭

4. **查看聊天框**
   - 右侧聊天框会自动填充文本
   - 格式：`请解释以下内容：\n\n"[你选择的文本]"`

5. **发送给 AI**
   - 可以直接点击发送按钮
   - 或者修改问题后再发送
   - 按 Enter 键快速发送

### 步骤 4：获取 AI 回答

- AI 会实时流式返回答案
- 可以继续提问
- 可以选择新的文本继续对话

## 🎨 界面布局

```
┌────────────────────────────────────────────────────────────────┐
│  PDF Chatbot - AI 驱动的 PDF 阅读器                             │
├──────────────────────────────────┬─────────────────────────────┤
│                                  │                             │
│  PDF 阅读器                       │  AI 助手                     │
│  ┌────────────────────────────┐  │  ┌───────────────────────┐  │
│  │ [上传 PDF]                  │  │  │ 💬 AI 助手            │  │
│  └────────────────────────────┘  │  │ 选择文本后快速提问     │  │
│                                  │  └───────────────────────┘  │
│  ┌────────────────────────────┐  │                             │
│  │ [工具栏]                    │  │  ┌───────────────────────┐  │
│  │ ← 1/10 →  [100%] [搜索]    │  │  │ 对话消息区域           │  │
│  └────────────────────────────┘  │  │                        │  │
│                                  │  │ 用户: 请解释...         │  │
│  ┌────────────────────────────┐  │  │ AI: 这段内容是...       │  │
│  │                            │  │  │                        │  │
│  │   PDF 内容显示区域          │  │  │                        │  │
│  │                            │  │  └───────────────────────┘  │
│  │   [选择文本后弹出菜单]      │  │                             │
│  │   ┌──────────────────┐     │  │  ┌───────────────────────┐  │
│  │   │ 📝 高亮          │     │  │  │ [输入框]              │  │
│  │   │ 📝 下划线        │     │  │  │ 输入消息...            │  │
│  │   │ 📝 删除线        │     │  │  │                  [发送]│  │
│  │   │ 💬 发送到 AI     │     │  │  └───────────────────────┘  │
│  │   └──────────────────┘     │  │                             │
│  │                            │  │                             │
│  └────────────────────────────┘  │                             │
│                                  │                             │
└──────────────────────────────────┴─────────────────────────────┘
```

## 💡 使用技巧

### 1. 快速提问
- 选择关键词或专业术语
- 点击"发送到 AI"
- 快速获得解释

### 2. 理解复杂段落
- 选择整段文本
- 让 AI 解释和总结
- 可以追问细节

### 3. 对比学习
- 选择不同部分的文本
- 分别提问
- 对比 AI 的解释

### 4. 批注 + AI
- 先用高亮标记重点
- 再用"发送到 AI"深入理解
- 结合使用效果更好

### 5. 自定义问题
- 点击"发送到 AI"后
- 在聊天框中修改问题
- 添加更多上下文

## ⚡ 快捷操作

| 操作 | 方法 |
|------|------|
| 发送消息 | `Enter` |
| 换行 | `Shift + Enter` |
| 搜索 PDF | `Ctrl/Cmd + F` |
| 关闭菜单 | 点击其他地方 |

## 🔧 自定义配置

### 修改提示词格式

编辑 `/components/ChatPanel.tsx`：

```typescript
const prompt = `请解释以下内容：\n\n"${selectedText}"`;
```

可以改为：

```typescript
// 简洁版
const prompt = selectedText;

// 详细版
const prompt = `作为一个专业的文档助手，请详细解释以下内容，包括背景知识和实际应用：\n\n"${selectedText}"`;

// 翻译版
const prompt = `请翻译并解释以下内容：\n\n"${selectedText}"`;
```

### 修改按钮样式

编辑 `/public/web/chat-integration.js`：

```javascript
chatButton.innerHTML = '💬 发送到 AI';  // 修改文本
chatButton.style.background = '#3b82f6';  // 修改颜色
```

## 📊 使用场景

### 学术论文阅读
- 选择专业术语 → AI 解释
- 选择复杂公式 → AI 说明
- 选择结论部分 → AI 总结

### 技术文档学习
- 选择代码片段 → AI 解释
- 选择配置说明 → AI 指导
- 选择错误信息 → AI 排查

### 合同文件审阅
- 选择法律条款 → AI 解读
- 选择关键条件 → AI 分析
- 选择风险点 → AI 提示

### 外文资料理解
- 选择段落 → AI 翻译
- 选择专业词汇 → AI 解释
- 选择文化背景 → AI 说明

## 🎯 最佳实践

1. **选择合适的文本长度**
   - 太短：缺少上下文
   - 太长：AI 回答可能过于宽泛
   - 建议：1-3 句话

2. **逐步深入**
   - 先问整体概念
   - 再问具体细节
   - 最后问应用场景

3. **结合批注**
   - 重要内容用高亮标记
   - 疑问处用下划线
   - 需要深入理解的发送给 AI

4. **保持对话连贯**
   - 在同一主题下连续提问
   - AI 会记住上下文
   - 可以追问"为什么"、"如何"

## 🐛 常见问题

### Q: 菜单没有出现？
A: 确保选择了文本，等待 0.5 秒让菜单加载。

### Q: 按钮点击没反应？
A: 检查浏览器控制台，确认没有错误。

### Q: 文本没有填充到聊天框？
A: 刷新页面重试，确认 iframe 通信正常。

### Q: AI 回答不准确？
A: 尝试选择更多上下文，或修改问题更具体。

## 📚 相关文档

- [CHAT_INTEGRATION.md](./CHAT_INTEGRATION.md) - 技术实现细节
- [QUICKSTART.md](./QUICKSTART.md) - 快速启动
- [README.md](./README.md) - 项目概述

---

享受你的 PDF + AI 学习体验！🚀
